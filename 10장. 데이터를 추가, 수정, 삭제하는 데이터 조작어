--데이블 생성
CREATE TABLE DEPT_TEMP
    AS SELECT * FROM DEPT;
    
SELECT * FROM DEPT_TEMP;

--INSERT 문
INSERT INTO DEPT_TEMP (DEPTNO, DNAME, LOC)
               VALUES (50, 'DATABSE', 'SEOUL');
               
INSERT INTO DEPT_TEMP
      VALUES (60, 'NETWORK', 'BUSAN');
      
SELECT * FROM DEPT_TEMP;

INSERT INTO DEPT_TEMP (DEPTNO, DNAME, LOC)
               VALUES (90, 'WEB', NULL);
               
INSERT INTO DEPT_TEMP (DEPTNO, DNAME, LOC)
               VALUES (80, 'MOBILE', '');
               
INSERT INTO DEPT_TEMP (DEPTNO,  LOC)
               VALUES (90, 'INCHEON');
               
CREATE TABLE EMP_TEMP
    AS SELECT *
         FROM EMP
        WHERE 1 <> 1;

SELECT * FROM EMP_TEMP;

INSERT INTO EMP_TEMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)
              VALUES (9999, '홍길동', 'PRESIDENT', NULL, '2001/01/01', 5000, 1000, 10);
              
INSERT INTO EMP_TEMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)
              VALUES (1111, '성춘향', 'MANAGER', 9999, '2001-01-05', 4000, NULL, 20);    
              
INSERT INTO EMP_TEMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)
              VALUES (2111, '이순신', 'MANAGER', 9999, '07/01/2001', 4000, NULL, 20);  --날짜 반대 : 오류
              
INSERT INTO EMP_TEMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)
              VALUES (2111, '이순신', 'MANAGER', 9999,  TO_DATE('07/01/2001', 'DD/MM/YYYY'), 4000, NULL, 20);
                        
INSERT INTO EMP_TEMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)
              VALUES (3111, '심청이', 'MANAGER', 9999, SYSDATE, 4000, NULL, 30);
              
INSERT INTO EMP_TEMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)
     SELECT E.EMPNO, E.ENAME, E.JOB, E.MGR, E.HIREDATE, E.SAL, E.COMM, E.DEPTNO
       FROM EMP E, SALGRADE S
      WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL
        AND S.GRADE = 1;
        
-- UPDATE 문
CREATE TABLE DEPT_TEMP2
    AS SELECT * FROM DEPT;
    
SELECT * FROM DEPT_TEMP2;

UPDATE DEPT_TEMP2
   SET LOC = 'SEOUL';
   
ROLLBACK;

UPDATE DEPT_TEMP2
   SET DNAME = 'DATABSE',
       LOC   = 'SEOUL'
 WHERE DEPTNO = 40;
 
UPDATE DEPT_TEMP2
   SET (DNAME, LOC) = (SELECT DNAME, LOC
                         FROM DEPT
                        WHERE DEPTNO = 40)
 WHERE DEPTNO = 40;
 
SELECT * FROM DEPT_TEMP2;

UPDATE DEPT_TEMP2
   SET DNAME = (SELECT DNAME
                  FROM DEPT
                 WHERE DEPTNO = 40),
        LOC = (SELECT LOC
                 FROM DEPT
                WHERE DEPTNO = 40)
    WHERE DEPTNO = 40;
    
UPDATE DEPT_TEMP2
   SET LOC = 'SEOUL'
 WHERE DEPTNO = (SELECT DEPTNO
                   FROM DEPT_TEMP2
                  WHERE DNAME = 'OPERATIONS');
                  
-- DELETE 문
CREATE TABLE EMP_TEMP2
    AS SELECT * FROM EMP;
    
SELECT * FROM EMP_TEMP2;

DELETE FROM EMP_TEMP2
 WHERE JOB = 'MANAGER';
 
DELETE FROM EMP_TEMP2
  WHERE EMPNO IN (SELECT E.EMPNO
                    FROM EMP_TEMP2 E, SALGRADE S
                   WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL
                     AND S.GRADE = 3
                     AND DEPTNO = 30);

DELETE FROM EMP_TEMP2;